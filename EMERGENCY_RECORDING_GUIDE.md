# 緊急錄影功能測試指南

## 🚨 新功能說明

我們新增了一個**緊急錄影**功能來解決 "Camera is not ready yet" 的問題。

### 功能特點

1. **智能錄影檢查** - startRecording 現在有三重檢查機制
2. **緊急錄影按鈕** - 當相機未準備好時會顯示
3. **多重重試機制** - 自動重試 3 次
4. **強制錄影選項** - 繞過準備檢查

## 🎯 測試步驟

### 1. 正常錄影測試
- 打開翻譯頁面
- 等待相機準備完成（綠色錄影按鈕）
- 點擊錄影按鈕
- 應該正常開始錄影

### 2. 緊急錄影測試
- 如果相機顯示未準備好（灰色錄影按鈕）
- 應該會看到**紅色的「緊急錄影」按鈕**
- 點擊緊急錄影按鈕
- 系統會繞過準備檢查直接開始錄影

### 3. 強制錄影測試
- 當相機未準備好時點擊正常錄影按鈕
- 會彈出對話框詢問是否強制錄影
- 選擇「強制錄影」
- 系統會標記相機為強制準備狀態並開始錄影

### 4. 自動重試測試
- 如果仍遇到 "Camera is not ready" 錯誤
- 系統會自動重試最多 3 次
- 每次重試間隔 1 秒
- 如果 3 次都失敗，會顯示詳細錯誤信息

## 🔧 解決方案層級

```
1. 正常錄影（isCameraReady = true）
   ↓ 失敗
2. 智能檢查（forceReady 或 cameraReadyAttempts >= 2）
   ↓ 失敗
3. 用戶選擇強制錄影
   ↓ 失敗
4. 緊急錄影（完全繞過檢查）
   ↓ 失敗
5. 自動重試機制（最多 3 次）
```

## 📱 UI 變化

- **錄影按鈕**: 灰色=未準備, 藍色=準備好, 紅色=錄影中
- **緊急錄影按鈕**: 只在相機未準備時顯示，紅色警告圖示
- **狀態指示**: 控制台會顯示詳細的準備狀態

## 🐛 如果還是有問題

1. 檢查控制台日誌，看哪個步驟失敗
2. 嘗試重設相機（診斷工具中有選項）
3. 檢查權限設置
4. 重啟應用

## 📋 測試清單

- [ ] 正常錄影功能
- [ ] 緊急錄影按鈕顯示
- [ ] 緊急錄影功能
- [ ] 強制錄影對話框
- [ ] 自動重試機制
- [ ] 錯誤處理
- [ ] 相機狀態重設

---

現在應該能夠在大多數情況下成功錄影了！如果還有問題，請查看控制台日誌來確定具體的失敗原因。